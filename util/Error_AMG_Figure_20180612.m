function Error_AMG_Figure

%======Coarse DOF = 141==========================
Err=[
0.00808003729418   0.000003856474535  0.000000023413111  0.000000000182396  0.000000000000359   0.000000000003332  0.000000000002348  0.000000000000981  0.000000000002963   0.000000000002220   0.000000000002618  0.000000000003972
0.02389103918073   0.000011156947970  0.000000076347987  0.000000000675030  0.000000000006921   0.000000000000227  0.000000000001734  0.000000000005890  0.000000000003794   0.000000000008676   0.000000000004611  0.000000000006580
0.04035148260842   0.000059389449603  0.000000707069205  0.000000009496105  0.000000000136417   0.000000000007809  0.000000000003752  0.000000000003887  0.000000000008406   0.000000000003567   0.000000000004164  0.000000000000803
0.08880644119717   0.000049388004840  0.000000603886292  0.000000009696635  0.000000000190965   0.000000000000611  0.000000000000242  0.000000000001606  0.000000000005286   0.000000000005116   0.000000000021728  0.000000000022908
0.81286223843186   0.000198351240940  0.000003284281306  0.000000068007992  0.000000001923695   0.000000000071523  0.000000000008029  0.000000000003737  0.000000000000384   0.000000000026361   0.000000000012633  0.000000000007276
0.10810681298778   0.000316673051856  0.000005833132093  0.000000122402625  0.000000002452538   0.000000000046285  0.000000000006708  0.000000000000796  0.000000000007432   0.000000000005798   0.000000000001663  0.000000000014708
0.01894954759984   0.000451877666393  0.000012485597324  0.000000390485297  0.000000013010009   0.000000000452275  0.000000000003894  0.000000000001052  0.000000000015518   0.000000000012932   0.000000000000853  0.000000000011312
0.12437510438599   0.001810101989065  0.000072686257653  0.000003293462697  0.000000160051997   0.000000008136738  0.000000000402650  0.000000000018048  0.000000000040046   0.000000000006537   0.000000000016428  0.000000000001592
0.47886282039442   0.001844639487786  0.000117741541629  0.000008977374677  0.000000728068073   0.000000060365323  0.000000005051049  0.000000000440849  0.000000000011937   0.000000000007901   0.000000000005855  0.000000000010601
0.33542247520657   0.004324401881775  0.000267257334770  0.000018953319653  0.000001501142975   0.000000131805763  0.000000012596558  0.000000001286622  0.000000000115534   0.000000000003837   0.000000000005883  0.000000000014893
0.96679485368406   0.002766937016133  0.000220838062859  0.000023202889963  0.000002840273311   0.000000375559637  0.000000051429936  0.000000007176595  0.000000000996636   0.000000000161918   0.000000000005372  0.000000000003212
1.48465260692518   0.009515952362364  0.001002316607412  0.000096638853790  0.000007839202539   0.000000756033074  0.000000078139692  0.000000008814197  0.000000001123567   0.000000000204011   0.000000000060709  0.000000000011738
0.09670170839905   0.011848831310800  0.001145828192932  0.000174395259194  0.000034135940609   0.000006848840599  0.000001437051168  0.000000308310035  0.000000066801903   0.000000014507862   0.000000003138325  0.000000000662169];

figure(1)
Steps = size(Err,2);
Num_Eig = size(Err,1);
% %--------------------------------------------------------------------------
for i = 1 : Num_Eig
    semilogy(1:Steps,Err(i,1:Steps),'-o','LineWidth',3,'markersize',14)
    hold on
end
% %--------------------------------------------------------------------------
[val,ind] = max(Err(:,end));
r = Err(ind,end)/Err(ind,3);
r = exp(log(r)/(Steps-3));
% %--------------------------------------------------------------------------
%semilogy(1:Steps,Err(end,2)/(r^2)*r.^([1:Steps]),'-*','LineWidth',3,'markersize',14)
semilogy(1:Steps,2*Err(ind,3)/(r^3)*r.^([1:Steps]),'-*','LineWidth',3,'markersize',14)
hold off
% %--------------------------------------------------------------------------
word = {'1-st eigenvalue', '2-nd eigenvalue', '3-rd eigenvalue '};
for i = 4 : Num_Eig
    word = [word,{[num2str(i) '-th eigenvalue']}];    
end
word1 = [num2str(r) '^k'];
word = [word,{word1}];
legend(word);
set(gca, 'FontSize', 16)
title('Convergence behavior of multigrid method for eigenvalue problem','fontsize',18)
xlabel('Number of iterations','fontsize',18)
ylabel('Eigenvalue error','fontsize',18)
axis([0 22, 1e-15 1e5])


%================Coarse DOF = 542==============
Err=[
0.003636473802732  0.000001127419523  0.000000004155844  0.000000000018606   0.000000000000032   0.000000000001265  0.000000000004430
0.013079349906903  0.000003360010972  0.000000012488350  0.000000000062727   0.000000000003539   0.000000000006594  0.000000000001002
0.017884913371596  0.000005975615842  0.000000024678528  0.000000000134435   0.000000000005009   0.000000000000853  0.000000000004690
0.028815232384275  0.000007421230535  0.000000030859212  0.000000000173529   0.000000000006494   0.000000000001251  0.000000000002558
0.285523012924628  0.000020931619702  0.000000098887128  0.000000000890410   0.000000000024258   0.000000000011212  0.000000000007375
0.053656604994373  0.000034574979082  0.000000227436800  0.000000001384905   0.000000000007944   0.000000000020364  0.000000000021672
0.010475684965314  0.000080158320884  0.000000650447305  0.000000005838331   0.000000000043514   0.000000000013983  0.000000000017167
0.054628708438770  0.000135629835597  0.000001374865633  0.000000015942049   0.000000000192301   0.000000000033111  0.000000000004320
0.255249623275034  0.000094797098086  0.000000868104394  0.000000012100060   0.000000000214300   0.000000000000568  0.000000000003354
0.093371845546898  0.000481221972109  0.000009519014327  0.000000233190633   0.000000006604409   0.000000000204494  0.000000000009663
0.068084942751995  0.000252941904478  0.000003252055933  0.000000044880153   0.000000000652506   0.000000000012420  0.000000000006935
0.229023606373403  0.000396589369416  0.000006902713324  0.000000152791273   0.000000010616588   0.000000001428390  0.000000000047521
0.012502754085574  0.001132524351846  0.000029408310041  0.000000929849278   0.000000027320169   0.000000000099448  0.000000000013557];

figure(2)
Steps = size(Err,2);
Num_Eig = size(Err,1);
% %--------------------------------------------------------------------------
for i = 1 : Num_Eig
    semilogy(1:Steps,Err(i,1:Steps),'-o','LineWidth',3,'markersize',14)
    hold on
end
% %--------------------------------------------------------------------------
[val,ind] = max(Err(:,end));
r = Err(ind,end)/Err(ind,3);
r = exp(log(r)/(Steps-3));
% %--------------------------------------------------------------------------
%semilogy(1:Steps,Err(end,2)/(r^2)*r.^([1:Steps]),'-*','LineWidth',3,'markersize',14)
semilogy(1:Steps,2*Err(ind,3)/(r^3)*r.^([1:Steps]),'-*','LineWidth',3,'markersize',14)
hold off
% %--------------------------------------------------------------------------
word = {'1-st eigenvalue', '2-nd eigenvalue', '3-rd eigenvalue'};
for i = 4 : Num_Eig
    word = [word,{[num2str(i) '-th eigenvalue']}];    
end
word1 = [num2str(r) '^k'];
word = [word,{word1}];
legend(word);
set(gca, 'FontSize', 16)
title('Convergence behavior of multigrid method for eigenvalue problem','fontsize',18)
xlabel('Number of iterations','fontsize',18)
ylabel('Eigenvalue error','fontsize',18)
axis([0 12, 1e-15 1e5])

%========Coarse DOF=2109=======
Err=[
0.001342766826220  0.000000349889014  0.000000000638654  0.000000000003972  0.000000000001410
0.004654661453671  0.000005588012826  0.000000001763780  0.000000000003539  0.000000000000469
0.004758975608013  0.000003683057457  0.000000001726335  0.000000000006509  0.000000000002679
0.009918026241380  0.000001789626907  0.000000003311769  0.000000000010317  0.000000000015788
0.069689764172097  0.000002671744397  0.000000005844029  0.000000000065029  0.000000000004121
0.012341816329524  0.000002823875263  0.000000005954931  0.000000000016428  0.000000000006281
0.008994766451622  0.000011381256485  0.000000023830751  0.000000000070600  0.000000000011937
0.009752496159962  0.000002886215441  0.000000022264715  0.000000000087056  0.000000000016541
0.062329253903897  0.000016475907842  0.000000040863284  0.000000000239993  0.000000000016968
0.062185620301904  0.000003051919919  0.000000041292168  0.000000000274952  0.000000000013983
0.024438399022529  0.000018626865938  0.000000078458925  0.000000000420840  0.000000000003411
0.055073247949252  0.000015981016020  0.000000051565252  0.000000000211799  0.000000000025665
0.036437353455312  0.000027225150319  0.000000160310634  0.000000001117712  0.000000000013273];

Err = Err(:,1:end-1);

sum(Err)

figure(3)
Steps = size(Err,2);
Num_Eig = size(Err,1);
% %--------------------------------------------------------------------------
for i = 1 : Num_Eig
    semilogy(1:Steps,Err(i,1:Steps),'-o','LineWidth',3,'markersize',14)
    hold on
end
% %--------------------------------------------------------------------------
[val,ind] = max(Err(:,end));
r = Err(ind,end)/Err(ind,3);
r = exp(log(r)/(Steps-3));
% %--------------------------------------------------------------------------
%semilogy(1:Steps,Err(end,2)/(r^2)*r.^([1:Steps]),'-*','LineWidth',3,'markersize',14)
semilogy(1:Steps,2*Err(ind,3)/(r^3)*r.^([1:Steps]),'-*','LineWidth',3,'markersize',14)
hold off
% %--------------------------------------------------------------------------
word = {'1-st eigenvalue', '2-nd eigenvalue','3-rd eigenvalue'};
for i = 4 : Num_Eig
    word = [word,{[num2str(i) '-th eigenvalue']}];    
end
word1 = [num2str(r) '^k'];
word = [word,{word1}];
legend(word);
set(gca, 'FontSize', 16)
title('Convergence behavior of multigrid method for eigenvalue problem','fontsize',18)
xlabel('Number of iterations','fontsize',18)
ylabel('Eigenvalue error','fontsize',18)
axis([0 9, 1e-15 1e5])

%======For the 13-th eigenvalue: Coarse DOF=141=====
Err= [
33.396063442607215
 0.096701724751227
 0.024696155846328
 0.087968905535121
 0.556346237804576
 4.177650269499480
26.400947256828516
28.690832619091253
29.324592628931157
29.505462058072766
29.566015522604715
29.589390731649900
29.599652726185269
29.604550916575050
29.607002012062026
29.608287982174431
29.608980157177996
29.609393935367478
29.609667161537658
29.609897673982630];

figure(4)
Err=Err';
[val,ind] = max(Err(end,:));
Steps = size(Err,2);
Num_Eig = size(Err,1);
% %--------------------------------------------------------------------------
for i = 1 : Num_Eig
    semilogy(1:Steps,Err(i,1:Steps),'-o','LineWidth',3,'markersize',14)
    hold on
end

% r = Err(ind,end)/Err(ind,3);
% r = exp(log(r)/(Steps-3));
% % %------------------------------------------------------------------------
% semilogy(1:Steps,2*Err(ind,3)/(r^3)*r.^([1:Steps]),'-*','LineWidth',3,'markersize',14)
hold off
% %--------------------------------------------------------------------------
word = {'13-th eigenvalue'};
% word1 = [num2str(r) '^k'];
% word = [word,{word1}];
legend(word);
set(gca, 'FontSize', 16)
title('Convergence behavior of multigrid method for eigenvalue problem','fontsize',18)
xlabel('Number of iterations','fontsize',18)
ylabel('Eigenvalue error','fontsize',18)


%=====For one eigenvalue: COarse DOF = 542======
Err=[
14.013401786984275
 0.012502772644581
 0.000580492392118
 0.000020337886525
 0.000000654582863
 0.000000015189784
 0.000000006603358
 0.000000007394704
 0.000000007445124
 0.000000007419942
 0.000000007398910
 0.000000007397773
 0.000000007369096
 0.000000007361820
 0.000000007366111
 0.000000007316061
 0.000000007313702
 0.000000007359517
 0.000000007315492
 0.000000007307221];

figure(5)
Err=Err';
[val,ind] = max(Err(end,:));
Steps = size(Err,2);
Num_Eig = size(Err,1);
% %--------------------------------------------------------------------------
for i = 1 : Num_Eig
    semilogy(1:Steps,Err(i,1:Steps),'-o','LineWidth',3,'markersize',14)
    hold on
end

% r = Err(ind,end)/Err(ind,3);
% r = exp(log(r)/(Steps-3));
% % %------------------------------------------------------------------------
% semilogy(1:Steps,2*Err(ind,3)/(r^3)*r.^([1:Steps]),'-*','LineWidth',3,'markersize',14)
hold off
% %--------------------------------------------------------------------------
word = {'13-th eigenvalue'};
%word1 = [num2str(r) '^k'];
%word = [word,{word1}];
legend(word);
set(gca, 'FontSize', 16)
title('Convergence behavior of multigrid method for eigenvalue problem','fontsize',18)
xlabel('Number of iterations','fontsize',18)
ylabel('Eigenvalue error','fontsize',18)


%===========For one eigenvalue, Coarse DOF = 2109===
Err=[
3.931593875710604
0.055073308449977
0.000014327966369
0.000000031038525
0.000000002872781
0.000000000115506];

figure(6)
Err=Err';
[val,ind] = max(Err(end,:));
Steps = size(Err,2);
Num_Eig = size(Err,1);
% %--------------------------------------------------------------------------
for i = 1 : Num_Eig
    semilogy(1:Steps,Err(i,1:Steps),'-o','LineWidth',3,'markersize',14)
    hold on
end

r = Err(ind,end)/Err(ind,3);
r = exp(log(r)/(Steps-3));
% %------------------------------------------------------------------------
semilogy(1:Steps,2*Err(ind,3)/(r^3)*r.^([1:Steps]),'-*','LineWidth',3,'markersize',14)
hold off
% %--------------------------------------------------------------------------
word = {'13-th eigenvalue'};
word1 = [num2str(r) '^k'];
word = [word,{word1}];
legend(word);
set(gca, 'FontSize', 16)
title('Convergence behavior of multigrid method for eigenvalue problem','fontsize',18)
xlabel('Number of iterations','fontsize',18)
ylabel('Eigenvalue error','fontsize',18)
